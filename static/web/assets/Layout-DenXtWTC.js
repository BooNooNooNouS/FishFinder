import{cb as ct,cc as dt,cd as ut,ce as ht,cf as U,cg as W,j as e,ch as pt,a1 as ie,F as se,r as h,ci as Te,O as He,bL as gt,cj as mt,U as ft,ck as xt,N as St,cl as jt,cm as _t,cn as bt,co as vt,cp as yt,u as ce,i as l,aG as K,cq as kt,cr as Et,cs as ae,bJ as N,bK as V,ae as At,ct as wt,cu as Ct,cv as k,G as R,B as T,cw as Rt,cx as It,A as P,cy as Nt,a$ as Pe,b0 as Vt,cz as zt,cA as Dt,cB as Lt,S as oe,bP as ye,cC as Ot,D as ke,cD as Ee,k as Tt,cE as Me,bR as G,z as Ae,bO as we,bU as de,I as Ht,C as Ue,L as We,d as Be,cF as Fe,cG as Pt,Y as Mt,cH as Ut,bW as le,cI as Wt,a4 as ue,c5 as Bt,cJ as Ft,bd as Qt,cK as _e,s as $t,cL as Kt,aT as Zt,b$ as Gt,cM as Xt,b1 as qt,bV as re}from"./vendor-DM3YzW4g.js";import{u as Qe,b as B,v as be,l as Jt,n as Q,f as $e,m as A,U as v,a as Y,e as ee,A as te,M as Ke,h as Yt,g as Ze,o as Ce,p as es,r as Ge,c as ts,d as ss}from"./index-D337eai7.js";import{a as ns,s as is,l as os,d as rs,D as as,A as ls,g as De}from"./links-Cv01nrl7.js";import{o as cs,B as ds,a as $,S as Re,I as Le,k as Ie,l as us,u as Xe,O as hs,j as ps}from"./ThemeContext-Ch4E8_Wm.js";import{u as gs}from"./UsePluginUIFeature-BRdvE5aG.js";import{A as ms}from"./Alerts-BbzMyEmS.js";import{L as ve,N as fs}from"./DesktopAppView-DyVa6oYc.js";import{u as xs}from"./UseInstanceName-COxSnfzz.js";import{R as Ss}from"./UseForm-TWh6_feP.js";import{g as js}from"./ModelType-B9P_b1nX.js";import"./PluginSource-BculEAAL.js";import"./ActionButton-Q09YVtCx.js";const _s=()=>ct({opened:!1,empty:!1,selected:-1,listId:"",query:"",registeredActions:new Set}),bs=s=>dt(s);function X(s,t){const n=t.getState();t.setState({...n,...s(t.getState())})}function qe(s){X(()=>({opened:!0,selected:-1}),s)}function Je(s){X(()=>({opened:!1}),s)}function Ye(s){X(t=>({opened:!t.opened,selected:t.opened?t.selected:-1}),s)}function et(s,t){t.updateState(n=>({...n,selected:s}))}function vs(s,t){t.updateState(n=>({...n,listId:s}))}function he(s,t=document){const n=t.querySelector(s);if(n)return n;const o=t instanceof ShadowRoot?t.host.children:t.children;for(let r=0;r<o.length;r+=1){const i=o[r];if(i.shadowRoot){const d=he(s,i.shadowRoot);if(d)return d}const a=he(s,i);if(a)return a}return null}function pe(s,t){var m,c;const n=t.getState(),o=n.listId?he(`#${n.listId}`):null,r=o==null?void 0:o.querySelector("[data-selected]"),i=(o==null?void 0:o.querySelectorAll("[data-action]"))??[],a=s===-1?i.length-1:s===i.length?0:s,d=ut(a,0,i.length-1);return r==null||r.removeAttribute("data-selected"),(m=i[d])==null||m.scrollIntoView({block:"nearest"}),(c=i[d])==null||c.setAttribute("data-selected","true"),et(d,t),d}function ys(s){return pe(s.getState().selected+1,s)}function ks(s){return pe(s.getState().selected-1,s)}function Es(s){const t=s.getState(),n=he(`#${t.listId} [data-selected]`);n==null||n.click()}function As(s,t){const n=t.getState();return n.registeredActions.add(s),()=>{n.registeredActions.delete(s)}}function ws(s,t){X(()=>({query:s}),t),Promise.resolve().then(()=>{pe(0,t),X(n=>({empty:n.query.trim().length>0&&n.registeredActions.size===0||!1}),t)})}function Cs({clearQuery:s},t){t.updateState(n=>({...n,selected:-1,query:s?"":n.query,empty:s?!1:n.empty}))}const O={open:qe,close:Je,toggle:Ye,updateState:X,setSelectedAction:et,setListId:vs,selectAction:pe,selectNextAction:ys,selectPreviousAction:ks,triggerSelectedAction:Es,registerAction:As,setQuery:ws,clearSpotlightState:Cs};function tt(){const s=_s();return[s,{open:()=>qe(s),close:()=>Je(s),toggle:()=>Ye(s)}]}const[st,ge]=tt(),{open:Rn,close:In,toggle:Nn}=ge;function nt(s){const t=s;return t.group!==void 0&&Array.isArray(t.actions)}function Rs(s){return Array.isArray(s)?s.map(t=>t.trim()).join(",").toLowerCase().trim():typeof s=="string"?s.toLowerCase().trim():""}function Is(s){return s.reduce((t,n)=>"actions"in n?[...t,...n.actions.map(o=>({...o,group:n.group}))]:[...t,n],[])}function Ns(s){const t={},n=[];return s.forEach(o=>{o.group?(t[o.group]||(t[o.group]={pushed:!1,data:{group:o.group,actions:[]}}),t[o.group].data.actions.push(o),t[o.group].pushed||(t[o.group].pushed=!0,n.push(t[o.group].data))):n.push(o)}),n}const Vs=(s,t)=>{const n=s.trim().toLowerCase(),o=[[],[]];return Is(t).forEach(i=>{var a,d;(a=i.label)!=null&&a.toLowerCase().includes(n)?o[0].push(i):((d=i.description)!=null&&d.toLowerCase().includes(n)||Rs(i.keywords).includes(n))&&o[1].push(i)}),Ns(o.flat())};function it(s,t){if(!Array.isArray(s))return[];let n=0;return s.reduce((o,r)=>{if(n>=t)return o;if(nt(r)){const i=it(r.actions,t-n);o.push({group:r.group,actions:i}),n+=i.length}else o.push(r),n+=1;return o},[])}const[zs,q]=ht("Spotlight component was not found in tree");var H={root:"m_d2b315db",content:"m_3cd250e0",body:"m_d2abce9b",search:"m_f366a061",actionsList:"m_6e463822",action:"m_d49bb8ef",actionBody:"m_3d475731",actionSection:"m_832642f6",actionLabel:"m_6c2a1345",actionDescription:"m_a6d9d78d",empty:"m_82f78f74",footer:"m_ddcaf054",actionsGroup:"m_5a3e5f7b"};const Ds={dimmedSections:!0,highlightQuery:!1},ne=U((s,t)=>{const n=W("SpotlightAction",Ds,s),{className:o,style:r,classNames:i,styles:a,id:d,description:m,label:c,leftSection:u,rightSection:p,children:f,dimmedSections:b,highlightQuery:x,highlightColor:I,closeSpotlightOnTrigger:j,onClick:C,onMouseDown:w,keywords:M,vars:D,..._}=n,E=q(),g={classNames:i,styles:a},S=x&&typeof c=="string"?e.jsx(pt,{component:"span",highlight:E.query,color:I,...E.getStyles("actionLabel",g),children:c}):e.jsx("span",{...E.getStyles("actionLabel",g),children:c});return e.jsx(ie,{ref:t,"data-action":!0,...E.getStyles("action",{className:o,style:r,...g}),..._,onMouseDown:y=>{y.preventDefault(),w==null||w(y)},onClick:y=>{C==null||C(y),(j??E.closeOnActionTrigger)&&O.close(E.store)},tabIndex:-1,children:f||e.jsxs(e.Fragment,{children:[u&&e.jsx(se,{component:"span",mod:{position:"left",dimmed:b},...E.getStyles("actionSection",g),children:u}),e.jsxs("span",{...E.getStyles("actionBody",g),children:[S,e.jsx("span",{...E.getStyles("actionDescription",g),children:m})]}),p&&e.jsx(se,{component:"span",mod:{position:"right",dimmed:b},...E.getStyles("actionSection",g),children:p})]})})});ne.classes=H;ne.displayName="@mantine/spotlight/SpotlightAction";const Ls={},me=U((s,t)=>{const{className:n,style:o,styles:r,classNames:i,label:a,children:d,...m}=W("SpotlightActionsGroup",Ls,s),c=q();return e.jsx(se,{...c.getStyles("actionsGroup",{className:n,style:o,classNames:i,styles:r}),ref:t,...m,__vars:{"--spotlight-label":`'${a}'`},children:d})});me.classes=H;me.displayName="@mantine/core/SpotlightActionsGroup";const Os={},fe=U((s,t)=>{const{className:n,style:o,id:r,children:i,vars:a,classNames:d,styles:m,...c}=W("SpotlightActionsList",Os,s),u=q(),p=`mantine-${h.useId().replace(/:/g,"")}`,f=r||p;return h.useEffect(()=>(O.setListId(f,u.store),()=>O.setListId("",u.store)),[]),e.jsx(Te.Autosize,{...u.getStyles("actionsList",{className:n,style:o,classNames:d,styles:m}),ref:t,type:"scroll",scrollbarSize:"var(--spotlight-actions-list-padding)",offsetScrollbars:"y",id:f,...c,children:i})});fe.classes=H;fe.displayName="@mantine/spotlight/SpotlightActionsList";const Ts={},xe=U((s,t)=>{const{className:n,style:o,classNames:r,styles:i,...a}=W("SpotlightEmpty",Ts,s),d=q();return e.jsx(se,{ref:t,...d.getStyles("empty",{classNames:r,styles:i,className:n,style:o}),...a})});xe.classes=H;xe.displayName="@mantine/spotlight/SpotlightEmpty";const Hs={},Ne=U((s,t)=>{const{className:n,style:o,classNames:r,styles:i,...a}=W("SpotlightFooter",Hs,s),d=q();return e.jsx(se,{ref:t,...d.getStyles("footer",{className:n,classNames:r,style:o,styles:i}),...a})});Ne.classes=H;Ne.displayName="@mantine/spotlight/SpotlightFooter";function Ps(s,t){if(!s)return[];const n=()=>O.open(t);return Array.isArray(s)?s.map(o=>[o,n]):[[s,n]]}const Ms={size:600,yOffset:80,zIndex:He("max"),overlayProps:{backgroundOpacity:.35,blur:7},transitionProps:{duration:200,transition:"pop"},store:st,clearQueryOnClose:!0,closeOnActionTrigger:!0,shortcut:"mod + K",maxHeight:400,scrollable:!1},Se=U((s,t)=>{const n=W("SpotlightRoot",Ms,s),{classNames:o,className:r,style:i,styles:a,unstyled:d,vars:m,store:c,children:u,query:p,onQueryChange:f,transitionProps:b,clearQueryOnClose:x,shortcut:I,tagsToIgnore:j,triggerOnContentEditable:C,disabled:w,onSpotlightOpen:M,onSpotlightClose:D,forceOpened:_,closeOnActionTrigger:E,maxHeight:g,scrollable:S,...y}=n,L=gt(),{opened:F,query:rt}=bs(c),at=p||rt,ze=J=>{f==null||f(J),O.setQuery(J,c)},lt=mt({name:"Spotlight",classes:H,props:n,className:r,style:i,classNames:o,styles:a,unstyled:d});return ft(Ps(I,c),j,C),xt(()=>{F?M==null||M():D==null||D()},[F]),w?null:e.jsx(zs,{value:{getStyles:lt,query:at,setQuery:ze,store:c,closeOnActionTrigger:E},children:e.jsx(St,{ref:t,...y,withCloseButton:!1,opened:F||!!_,padding:0,onClose:()=>O.close(c),className:r,style:i,classNames:bt({theme:L,classNames:[H,o],props:n,stylesCtx:void 0}),styles:_t({theme:L,styles:a,props:n,stylesCtx:void 0}),transitionProps:{...b,onExited:()=>{var J;x&&ze(""),O.clearSpotlightState({clearQuery:x},c),(J=b==null?void 0:b.onExited)==null||J.call(b)}},__vars:{"--spotlight-max-height":S?jt(g):void 0},__staticSelector:"Spotlight","data-scrollable":S||void 0,children:u})})});Se.classes=H;Se.displayName="@mantine/spotlight/SpotlightRoot";const Us={size:"lg"},je=U((s,t)=>{const{classNames:n,styles:o,onKeyDown:r,onChange:i,vars:a,value:d,...m}=W("SpotlightSearch",Us,s),c=q(),u=c.getStyles("search"),[p,f]=h.useState(!1),b=x=>{r==null||r(x),!p&&(x.nativeEvent.code==="ArrowDown"&&(x.preventDefault(),O.selectNextAction(c.store)),x.nativeEvent.code==="ArrowUp"&&(x.preventDefault(),O.selectPreviousAction(c.store)),(x.nativeEvent.code==="Enter"||x.nativeEvent.code==="NumpadEnter")&&(x.preventDefault(),O.triggerSelectedAction(c.store)))};return e.jsx(vt,{ref:t,classNames:[{input:u.className},n],styles:[{input:u.style},o],...m,value:d??c.query,onChange:x=>{c.setQuery(x.currentTarget.value),i==null||i(x)},onKeyDown:b,onCompositionStart:()=>f(!0),onCompositionEnd:()=>f(!1)})});je.classes=H;je.displayName="@mantine/spotlight/SpotlightSearch";const Ws={size:600,yOffset:80,limit:1/0,zIndex:He("max"),overlayProps:{backgroundOpacity:.35,blur:7},transitionProps:{duration:200,transition:"pop"},store:st,filter:Vs,clearQueryOnClose:!0,closeOnActionTrigger:!0,shortcut:"mod + K",highlightQuery:!1},z=U((s,t)=>{const n=W("Spotlight",Ws,s),{searchProps:o,filter:r,query:i,onQueryChange:a,actions:d,nothingFound:m,highlightQuery:c,limit:u,...p}=n,[f,b]=yt({value:i,defaultValue:"",finalValue:"",onChange:a}),x=it(r(f,d),u).map(I=>{if(nt(I)){const j=I.actions.map(({id:C,...w})=>e.jsx(ne,{highlightQuery:c,...w},C));return e.jsx(me,{label:I.group,children:j},I.group)}return e.jsx(ne,{highlightQuery:c,...I},I.id)});return e.jsxs(Se,{...p,query:f,onQueryChange:b,ref:t,children:[e.jsx(je,{...o}),e.jsxs(fe,{children:[x,x.length===0&&m&&e.jsx(xe,{children:m})]})]})});z.classes=H;z.displayName="@mantine/spotlight/Spotlight";z.Search=je;z.ActionsList=fe;z.Action=ne;z.Empty=xe;z.ActionsGroup=me;z.Footer=Ne;z.Root=Se;z.open=ge.open;z.close=ge.close;z.toggle=ge.toggle;function Bs(s){return cs({modal:"qr",innerProps:{navigate:s}})}function Fs(s){const t=Qe(ce(r=>r.setNavigationOpen)),{user:n}=B(),o=[{id:"dashboard",label:l._({id:"7p5kLi"}),description:l._({id:"kwda2l"}),onClick:()=>{},leftSection:e.jsx(K,{size:"1.2rem"})},{id:"documentation",label:l._({id:"TvY/XA"}),description:l._({id:"hqbo9J"}),onClick:()=>{window.location.href=rs.faq},leftSection:e.jsx(K,{size:"1.2rem"})},{id:"about",label:l._({id:"iDxamh"}),description:l._({id:"gfhzPz"}),onClick:()=>ns(),leftSection:e.jsx(K,{size:"1.2rem"})},{id:"server-info",label:l._({id:"mHGdhG"}),description:l._({id:"Ckl0UI"}),onClick:()=>is(),leftSection:e.jsx(K,{size:"1.2rem"})},{id:"license-info",label:l._({id:"I/Xnkt"}),description:l._({id:"L23uA9"}),onClick:()=>os(),leftSection:e.jsx(K,{size:"1.2rem"})},{id:"navigation",label:l._({id:"rmlxV1"}),description:l._({id:"xIiHCw"}),onClick:()=>t(!0),leftSection:e.jsx(kt,{size:"1.2rem"})},{id:"scan",label:l._({id:"I+FvbD"}),description:l._({id:"9j/kJy"}),onClick:()=>Bs(s),leftSection:e.jsx(Et,{size:"1.2rem"})}];return n!=null&&n.is_staff&&o.push({id:"admin-center",label:l._({id:"uTLn08"}),description:l._({id:"txYotp"}),onClick:()=>{},leftSection:e.jsx(K,{size:"1.2rem"})}),o}var Qs="_1jb1pko0",$s="_1jb1pko1",Ks="_1jb1pko2",Zs="_1jb1pko3",ot="_1jb1pko7",Gs="_1jb1pko8",Xs="_1jb1pko9",qs="_1jb1pkoa",Js="_1jb1pkog";function Ys(){return e.jsx("div",{className:$s})}function en(){const[s,{open:t,close:n}]=ae(!1);return e.jsxs(e.Fragment,{children:[e.jsx(N,{position:"bottom-end",label:l._({id:"fNvDwV"}),children:e.jsx(V,{onClick:t,variant:"transparent",title:l._({id:"YzRRV6"}),children:e.jsx(At,{})})}),e.jsx(ds,{opened:s,onClose:n})]})}function tn(){return e.jsx(N,{position:"bottom-end",label:l._({id:"FcOU0s"}),children:e.jsx(V,{onClick:()=>fn.open(),variant:"transparent","aria-label":"open-spotlight",children:e.jsx(wt,{})})})}function sn(){const s=$(),[t,n]=B(ce(i=>[i.user,i.username])),{colorScheme:o,toggleColorScheme:r}=Ct();return e.jsxs(k,{width:260,position:"bottom-end",children:[e.jsx(k.Target,{children:e.jsx(ie,{className:Zs,children:e.jsxs(R,{gap:7,children:[n()?e.jsx(T,{fw:500,size:"sm",style:{lineHeight:1},mr:3,children:n()}):e.jsx(Rt,{height:20,width:40,radius:be.radiusDefault}),e.jsx(It,{})]})})}),e.jsxs(k.Dropdown,{children:[e.jsx(k.Label,{children:e.jsx(P,{id:"Tz0i8g"})}),e.jsx(k.Item,{leftSection:e.jsx(Nt,{}),component:ve,to:"/settings/user",children:e.jsx(P,{id:"Puv7+X"})}),(t==null?void 0:t.is_staff)&&e.jsx(k.Item,{leftSection:e.jsx(Pe,{}),component:ve,to:"/settings/system",children:e.jsx(P,{id:"zNkWa6"})}),(t==null?void 0:t.is_staff)&&e.jsx(k.Item,{leftSection:e.jsx(Vt,{}),component:ve,to:"/settings/admin",children:e.jsx(P,{id:"uTLn08"})}),(t==null?void 0:t.is_staff)&&e.jsx(k.Divider,{}),e.jsx(k.Item,{onClick:r,leftSection:o==="dark"?e.jsx(zt,{}):e.jsx(Dt,{}),c:o==="dark"?be.colors.yellow[4]:be.colors.blue[6],children:e.jsx(P,{id:"4i3x9F"})}),e.jsx(k.Divider,{}),e.jsx(k.Item,{leftSection:e.jsx(Lt,{}),onClick:()=>{Jt(s)},children:e.jsx(P,{id:"nOhz3x"})})]})]})}const nn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='400'%3e%3cg%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%3e%3cpath%20fill='%23ddbc91'%20d='M200%20199.906v193.196l166.305-96.016V103.139Z'/%3e%3cpath%20fill='%23d9b383'%20d='M200%20199.906v193.196L33.695%20297.086V103.139Z'/%3e%3cpath%20fill='%23ddbc91'%20d='M366.305%20103.139%20200%20199.906%2033.695%20103.14%20200%206.899z'/%3e%3cg%20fill='%23f3f4e4'%3e%3cpath%20d='M75.27%20127.109v145.46L200%20344.583l124.73-72.012V127.109L200%20199.684Z'/%3e%3cpath%20d='M324.73%20127.11%20200%20199.684%2075.27%20127.109%20200%2054.93Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20d='M200%2054.929v144.756L75.27%20272.569V127.11z'/%3e%3cpath%20fill='%23eaeccf'%20d='M200%2054.929v144.756l124.73%2072.884V127.11z'/%3e%3cpath%20fill='%2390a8d8'%20d='M200%20199.901V296.5l83.153-48.008v-96.973zm0%200V296.5l-83.153-48.008v-96.973zm83.153-48.383L200%20199.9l-83.153-48.383L200%20103.398Z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20443.959v216.54l186.4-107.618V335.499Zm0%200v216.54l-186.4-107.618V335.499Z'/%3e%3cpath%20d='m-360.266%20335.499-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20227.419v216.54l186.4-107.619V118.96Zm0%200v216.54l-186.4-107.619V118.96Z'/%3e%3cpath%20d='m-360.266%20118.959-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667%2010.879v216.54l186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23d9b383'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%20d='M-546.667%2010.879v216.54l-186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='m-360.266-97.581-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3cg%20fill='%23f3f4e4'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.058'%3e%3cpath%20stroke-width='3'%20d='M-686.466-70.715V92.321l139.798%2080.714%20139.801-80.714V-70.715l-139.8%2081.346z'/%3e%3cpath%20stroke-width='2.999'%20d='m-406.866-70.715-139.8%2081.345-139.801-81.345%20139.8-80.902Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l-139.8%2081.692V-70.715z'/%3e%3cpath%20fill='%23eaeccf'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l139.8%2081.692V-70.715z'/%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.999'%3e%3cpath%20d='M-546.667%2010.873v108.27l93.2-53.81v-108.69zm0%200v108.27l-93.2-53.81v-108.69z'/%3e%3cpath%20d='m-453.466-43.357-93.2%2054.23-93.201-54.23%2093.2-53.935Z'/%3e%3c/g%3e%3cpath%20fill='none'%20d='M-787.948-253.366h482.56v946.733h-482.56z'/%3e%3c/svg%3e";h.forwardRef((s,t)=>e.jsx("div",{ref:t,...s,children:e.jsx(fs,{to:"/",children:e.jsx(V,{size:28,variant:"transparent",children:e.jsx(Ve,{})})})}));const Ve=()=>e.jsx("img",{src:nn,alt:l._({id:"DVAy0b"}),height:28});function on({openDrawer:s}){return e.jsx(ie,{onClick:()=>s(),"aria-label":"navigation-menu",children:e.jsx(Ve,{})})}function Z({title:s,links:t,beforeClick:n}){const o=$(),r=h.useMemo(()=>t.filter(i=>!i.hidden),[t]);return r.length==0?null:e.jsx(e.Fragment,{children:e.jsxs(oe,{gap:"xs",children:[e.jsx(ye,{}),e.jsx(Re,{size:"md",children:s}),e.jsx(ye,{}),e.jsx(Ot,{cols:{base:1,"400px":2},type:"container",spacing:0,p:3,children:r.map(i=>e.jsx(N,{label:i.description,hidden:!i.description,children:i.link&&i.external?e.jsx(ke,{href:i.link,children:e.jsxs(R,{wrap:"nowrap",children:[i.external&&e.jsx(Le,{icon:i.icon??"link",iconProps:{size:"14"}}),e.jsx(T,{fw:500,p:5,children:i.title})]})}):e.jsx(ie,{onClick:a=>{i.link?(n==null||n(),Q(i.link,o,a)):i.action&&(n==null||n(),i.action())},children:e.jsxs(R,{wrap:"nowrap",children:[i.icon&&e.jsx(Le,{icon:i.icon,iconProps:{size:"14"}}),e.jsx(T,{fw:500,p:5,children:i.title})]})})},`menu-link-tooltip-${i.id}`))})]})})}const Oe=[];function rn({opened:s,close:t}){return e.jsx(Ee,{opened:s,onClose:t,size:"lg",withCloseButton:!1,classNames:{body:Js},children:e.jsx(an,{closeFunc:t})})}function an({closeFunc:s}){const t=B(),n=$e(),[o,r]=h.useState(0),i=h.useRef(null),{height:a}=Tt(),d=xs();h.useEffect(()=>{i.current!=null&&r(a-i.current.clientHeight-65)});const m=h.useMemo(()=>[{id:"home",title:l._({id:"7p5kLi"}),link:"/",icon:"dashboard"},{id:"parts",title:l._({id:"pmRbKZ"}),hidden:!t.hasViewPermission(A.part),link:"/part",icon:"part"},{id:"stock",title:l._({id:"blbbPS"}),link:"/stock",hidden:!t.hasViewPermission(A.stockitem),icon:"stock"},{id:"build",title:l._({id:"3ctapx"}),link:"/manufacturing/",hidden:!t.hasViewRole(v.build),icon:"build"},{id:"purchasing",title:l._({id:"UOTpFa"}),link:"/purchasing/",hidden:!t.hasViewRole(v.purchase_order),icon:"purchase_orders"},{id:"sales",title:l._({id:"mUv9U4"}),link:"/sales/",hidden:!t.hasViewRole(v.sales_order),icon:"sales_orders"},{id:"users",title:l._({id:"Sxm8rQ"}),link:"/core/index/users",icon:"user"},{id:"groups",title:l._({id:"zhrjek"}),link:"/core/index/groups",icon:"group"}],[t]),c=h.useMemo(()=>[{id:"barcode",title:l._({id:"fNvDwV"}),link:"/scan",icon:"barcode",hidden:!n.isSet("BARCODE_ENABLE")}],[t,n]),u=h.useMemo(()=>[{id:"notifications",title:l._({id:"iDNBZe"}),link:"/notifications",icon:"notification"},{id:"user-settings",title:l._({id:"ekfzWq"}),link:"/settings/user",icon:"user"},{id:"system-settings",title:l._({id:"zNkWa6"}),link:"/settings/system",icon:"system",hidden:!t.isStaff()},{id:"admin-center",title:l._({id:"uTLn08"}),link:"/settings/admin",icon:"admin",hidden:!t.isStaff()}],[t]),p=h.useMemo(()=>as(),[]),f=h.useMemo(()=>ls(n,t),[]);return e.jsxs(Me,{direction:"column",mih:"100vh",p:16,children:[e.jsxs(R,{wrap:"nowrap",children:[e.jsx(Ve,{}),e.jsx(Re,{size:"xl",children:d})]}),e.jsx(G,{h:"xs"}),e.jsx(Ae,{className:ot,p:0,children:e.jsxs(Te,{h:o,type:"always",offsetScrollbars:!0,children:[e.jsx(Z,{title:l._({id:"UxKoFf"}),links:m,beforeClick:s}),e.jsx(Z,{title:l._({id:"Tz0i8g"}),links:u,beforeClick:s}),e.jsx(Z,{title:l._({id:"7L01XJ"}),links:c,beforeClick:s}),e.jsx(G,{h:"md"}),Oe.length>0?e.jsx(Z,{title:l._({id:"ohUJJM"}),links:Oe,beforeClick:s}):e.jsx(e.Fragment,{})]})}),e.jsxs("div",{ref:i,children:[e.jsx(G,{h:"md"}),e.jsx(Z,{title:l._({id:"TvY/XA"}),links:p,beforeClick:s}),e.jsx(G,{h:"md"}),e.jsx(Z,{title:l._({id:"uyJsf6"}),links:f,beforeClick:s})]})]})}function ln({notification:s,onRead:t}){var a,d,m;const n=$();let o=(a=s.target)==null?void 0:a.link;const r=(d=s.target)==null?void 0:d.model_type,i=(m=s.target)==null?void 0:m.model_id;if(r){const c=Ke[r];c!=null&&c.url_detail&&i?o=Yt(r,i):c!=null&&c.url_overview&&(o=c.url_overview)}return e.jsx(Mt,{p:"xs",shadow:"xs",children:e.jsxs(R,{justify:"space-between",wrap:"nowrap",children:[e.jsx(N,{label:s.message,position:"bottom-end",hidden:!s.message,children:e.jsxs(oe,{gap:2,children:[e.jsx(ke,{href:o?`/${Ze()}${o}`:"#",underline:"hover",target:"_blank",onClick:c=>{o&&t(),o.startsWith("/")&&Q(o,n,c)},children:e.jsx(T,{size:"sm",children:s.name})}),e.jsx(T,{size:"xs",children:s.age_human})]})}),e.jsx(N,{label:l._({id:"+s1J8k"}),position:"bottom-end",children:e.jsx(V,{variant:"transparent",onClick:t,children:e.jsx(Fe,{})})})]})})}function cn({opened:s,onClose:t}){var m,c;const{isLoggedIn:n}=B(),o=$(),r=we({enabled:s&&n(),queryKey:["notifications",s],queryFn:async()=>Y.get(ee(te.notifications_list),{params:{read:!1,limit:10,ordering:"-creation"}}).then(u=>u.data),refetchOnMount:!1}),i=h.useMemo(()=>{var u,p;return(((p=(u=r.data)==null?void 0:u.results)==null?void 0:p.length)??0)>0},[r.data]),a=h.useCallback(()=>{Y.get(ee(te.notifications_readall),{params:{read:!1}}).catch(u=>{}).then(u=>{r.refetch()})},[]),d=h.useCallback(u=>{Y.patch(ee(te.notifications_list,u.pk),{read:!0}).then(()=>{r.refetch()}).catch(()=>{r.refetch()})},[]);return e.jsx(Ee,{opened:s,size:"md",position:"right",onClose:t,withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(R,{justify:"space-between",wrap:"nowrap",children:[e.jsx(Re,{size:"lg",children:l._({id:"iDNBZe"})}),e.jsxs(R,{justify:"end",wrap:"nowrap",children:[e.jsx(N,{label:l._({id:"onllUU"}),children:e.jsx(V,{variant:"transparent",onClick:()=>{a()},children:e.jsx(Fe,{})})}),e.jsx(N,{label:l._({id:"/WA/tl"}),children:e.jsx(V,{onClick:u=>{t(),Q("/notifications/unread",o,u)},variant:"transparent",children:e.jsx(Pt,{})})})]})]}),children:e.jsx(Ie,{label:"NotificationDrawer",children:e.jsxs(oe,{gap:"xs",children:[e.jsx(ye,{}),!r.isFetching&&!r.isLoading&&!r.isError&&!i&&e.jsx(de,{color:"green",icon:e.jsx(Ht,{}),children:e.jsx(T,{size:"sm",children:l._({id:"t2pqHO"})})}),i&&((c=(m=r.data)==null?void 0:m.results)==null?void 0:c.map(u=>e.jsx(ln,{notification:u,onRead:()=>d(u)},`notification-${u.pk}`))),r.isFetching&&e.jsx(Ue,{children:e.jsx(We,{size:"sm"})}),r.isError&&e.jsx(de,{color:"red",title:l._({id:"SlfejT"}),icon:e.jsx(Be,{}),children:e.jsx(T,{size:"sm",children:l._({id:"KEHQO1"})})})]})})})}function dn({searchText:s,query:t,navigate:n,onClose:o,onRemove:r,onResultClick:i}){const a=h.useMemo(()=>js(t.model),[t.model]),d=h.useMemo(()=>t.overviewUrl?t.overviewUrl:a.url_overview,[t,a]),m=h.useCallback(c=>{if(es(c),d){const u=`${d}?search=${s}`;Ge(c)||o(),Q(u,n,c)}else $t({title:l._({id:"FXAptz"}),message:l._({id:"RPZ4Cq"}),color:"red",icon:e.jsx(Be,{})})},[d,s]);return t.results.count==0?null:e.jsxs(le.Item,{value:t.model,children:[e.jsx(le.Control,{component:"div",children:e.jsxs(R,{justify:"space-between",children:[e.jsxs(R,{justify:"left",gap:5,wrap:"nowrap",children:[e.jsx(N,{label:l._({id:"XN9Er0"}),position:"top-start",children:e.jsx(V,{size:"sm",variant:"transparent",radius:"xs","aria-label":`view-all-results-${t.searchKey??t.model}`,disabled:!d,onClick:m,children:e.jsx(Kt,{})})}),e.jsx(T,{size:"lg",children:t.title??a.label_multiple}),e.jsxs(T,{size:"sm",style:{fontStyle:"italic"},children:[" ","- ",t.results.count," ",e.jsx(P,{id:"mO8KLE"})]})]}),e.jsxs(R,{justify:"right",wrap:"nowrap",children:[e.jsx(N,{label:l._({id:"8OvYje"}),position:"top-end",children:e.jsx(V,{size:"sm",color:"red",variant:"transparent",radius:"xs","aria-label":`remove-search-group-${t.model}`,onClick:()=>r(t.model),children:e.jsx(Zt,{})})}),e.jsx(G,{})]})]})}),e.jsx(le.Panel,{children:e.jsx(oe,{"aria-label":`search-group-results-${t.model}`,children:t.results.results.map(c=>e.jsx(ke,{underline:"never",onClick:u=>i(t.model,c.pk,u),children:e.jsx(Ss,{instance:c,model:t.model})},`result-${t.model}-${c.pk}`))})})]},t.model)}function un({opened:s,onClose:t}){const[n,o]=h.useState(""),[r]=Ut(n,500),i=B(),a=Ce(),[d,m]=h.useState(!1),[c,u]=h.useState(!1),[p,f]=h.useState(!1);h.useEffect(()=>{m(a.isSet("SEARCH_REGEX",!1)),u(a.isSet("SEARCH_WHOLE",!1)),f(a.isSet("SEARCH_NOTES",!1))},[a.isSet("SEARCH_REGEX",!1),a.isSet("SEARCH_WHOLE",!1),a.isSet("SEARCH_NOTES",!1)]);const b=h.useMemo(()=>[{model:A.part,parameters:{active:a.isSet("SEARCH_HIDE_INACTIVE_PARTS")?!0:void 0},enabled:i.hasViewRole(v.part)&&a.isSet("SEARCH_PREVIEW_SHOW_PARTS")},{model:A.supplierpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:i.hasViewRole(v.part)&&i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_SUPPLIER_PARTS")},{model:A.manufacturerpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:i.hasViewRole(v.part)&&i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_MANUFACTURER_PARTS")},{model:A.partcategory,parameters:{},enabled:i.hasViewRole(v.part_category)&&a.isSet("SEARCH_PREVIEW_SHOW_CATEGORIES")},{model:A.stockitem,parameters:{part_detail:!0,location_detail:!0,in_stock:a.isSet("SEARCH_PREVIEW_HIDE_UNAVAILABLE_STOCK")?!0:void 0},enabled:i.hasViewRole(v.stock)&&a.isSet("SEARCH_PREVIEW_SHOW_STOCK")},{model:A.stocklocation,parameters:{},enabled:i.hasViewRole(v.stock_location)&&a.isSet("SEARCH_PREVIEW_SHOW_LOCATIONS")},{model:A.build,parameters:{part_detail:!0},enabled:i.hasViewRole(v.build)&&a.isSet("SEARCH_PREVIEW_SHOW_BUILD_ORDERS")},{model:A.company,overviewUrl:"/purchasing/index/suppliers",searchKey:"supplier",title:l._({id:"9RecCt"}),parameters:{},enabled:i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.company,overviewUrl:"/purchasing/index/manufacturers",searchKey:"manufacturer",title:l._({id:"E0ub4Q"}),parameters:{},enabled:i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.company,overviewUrl:"/sales/index/customers",searchKey:"customer",title:l._({id:"NihQNk"}),parameters:{},enabled:i.hasViewRole(v.sales_order)&&a.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:A.purchaseorder,parameters:{supplier_detail:!0,outstanding:a.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_PURCHASE_ORDERS")?!0:void 0},enabled:i.hasViewRole(v.purchase_order)&&a.isSet("SEARCH_PREVIEW_SHOW_PURCHASE_ORDERS")},{model:A.salesorder,parameters:{customer_detail:!0,outstanding:a.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_SALES_ORDERS")?!0:void 0},enabled:i.hasViewRole(v.sales_order)&&a.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDERS")},{model:A.salesordershipment,parameters:{},enabled:i.hasViewRole(v.sales_order)&&a.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDER_SHIPMENTS")},{model:A.returnorder,parameters:{customer_detail:!0,outstanding:a.isSet("SEARCH_PREVIEW_EXCLUDE_INACTIVE_RETURN_ORDERS")?!0:void 0},enabled:i.hasViewRole(v.return_order)&&a.isSet("SEARCH_PREVIEW_SHOW_RETURN_ORDERS")}],[i,a]),x=h.useMemo(()=>b.filter(g=>g.enabled),[b]);h.useEffect(()=>{j.refetch()},[r]);const j=we({queryKey:["search",r,d,c,p],queryFn:async()=>{if(!r)return[];const g={offset:0,limit:a.getSetting("SEARCH_PREVIEW_RESULTS","10"),search:r,search_regex:d,search_whole:c,search_notes:p};return x.forEach(S=>{const y=S.searchKey||S.model;g[y]=S.parameters}),Y.post(ee(te.api_search),g).then(S=>S.data)}}),[C,w]=h.useState([]);h.useEffect(()=>{if(j.data){let g=x.filter(S=>(S.searchKey??S.model)in j.data);for(const S in j.data){const y=g.find(L=>(L.searchKey??L.model)==S);y&&(y.results=j.data[S])}g=g.filter(S=>S.results.count>0),w(g)}else w([])},[j.data]);function M(g){w(C.filter(S=>S.model!=g))}function D(){o(""),t()}const _=$();function E(g,S,y){const L=Ke[g];if(L.url_detail==null)return;Ge(y)||D();const F=L.url_detail.replace(":pk",S.toString());Q(F,_,y)}return e.jsx(Ee,{opened:s,size:"xl",onClose:D,position:"right",withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(R,{justify:"space-between",gap:1,wrap:"nowrap",children:[e.jsx(Bt,{"aria-label":"global-search-input",placeholder:l._({id:"Dwt0g3"}),value:n,onChange:g=>o(g.currentTarget.value),leftSection:e.jsx(ue,{size:"0.8rem"}),rightSection:n&&e.jsx(Ft,{color:"red",onClick:()=>o("")}),styles:{root:{width:"100%"}}}),e.jsx(N,{label:l._({id:"C0TDNl"}),position:"bottom-end",children:e.jsx(V,{size:"lg",variant:"transparent",onClick:()=>j.refetch(),children:e.jsx(Qt,{})})}),e.jsxs(k,{position:"bottom-end",children:[e.jsx(k.Target,{children:e.jsx(N,{label:l._({id:"9UYKcs"}),position:"bottom-end",children:e.jsx(V,{size:"lg",variant:"transparent",children:e.jsx(Pe,{})})})}),e.jsxs(k.Dropdown,{children:[e.jsx(k.Label,{children:l._({id:"9UYKcs"})}),e.jsx(k.Item,{children:e.jsx(_e,{label:l._({id:"roauu/"}),checked:c,onChange:g=>u(g.currentTarget.checked)})}),e.jsx(k.Item,{children:e.jsx(_e,{label:l._({id:"qkCZlJ"}),checked:d,onChange:g=>m(g.currentTarget.checked)})}),e.jsx(k.Item,{children:e.jsx(_e,{label:l._({id:"74yzDd"}),checked:p,onChange:g=>f(g.currentTarget.checked)})})]})]})]}),children:e.jsxs(Ie,{label:"SearchDrawer",children:[j.isFetching&&e.jsx(Ue,{children:e.jsx(We,{})}),!j.isFetching&&!j.isError&&e.jsx(oe,{gap:"md",children:e.jsx(le,{multiple:!0,defaultValue:x.map(g=>g.model),children:C.map((g,S)=>e.jsx(dn,{searchText:r,query:g,navigate:_,onClose:D,onRemove:y=>M(y),onResultClick:(y,L,F)=>E(y,L,F)},S))})}),j.isError&&e.jsx(de,{color:"red",radius:"sm",variant:"light",title:l._({id:"SlfejT"}),icon:e.jsx(Wt,{size:"1rem"}),children:e.jsx(P,{id:"hJCuaV"})}),r&&!j.isFetching&&!j.isError&&C.length==0&&e.jsx(de,{color:"blue",radius:"sm",variant:"light",title:l._({id:"MA3x23"}),icon:e.jsx(ue,{size:"1rem"}),children:e.jsx(P,{id:"dTtbrX"})})]})})}function hn(){const[s,t]=Qe(ce(_=>[_.setNavigationOpen,_.navigationOpen])),[n]=ts(ce(_=>[_.server])),[o,{open:r,close:i}]=ae(t),[a,{open:d,close:m}]=ae(!1),[c,{open:u,close:p}]=ae(!1),{isLoggedIn:f}=B(),[b,x]=h.useState(0),I=$e(),j=Ce(),C=h.useMemo(()=>{var _;return(_=n.customize)==null?void 0:_.navbar_message},[n.customize]),w=Gt(),M=we({queryKey:["notification-count",w],enabled:f()&&w==="visible",queryFn:async()=>!f()||w!="visible"?null:Y.get(ee(te.notifications_list),{params:{read:!1,limit:1}}).then(_=>{var E;return x(((E=_==null?void 0:_.data)==null?void 0:E.count)??0),_.data??null}),refetchInterval:60*1e3,refetchOnMount:!0});h.useEffect(()=>{t!==o&&s(o)},[o]),h.useEffect(()=>{t!==o&&(t?r():i())},[t]);const D=h.useMemo(()=>j.isSet("STICKY_HEADER",!0)?{position:"sticky",top:0}:{},[j]);return e.jsxs("div",{className:Qs,style:D,children:[e.jsx(un,{opened:a,onClose:m}),e.jsx(rn,{opened:o,close:i}),e.jsx(cn,{opened:c,onClose:()=>{M.refetch(),p()}}),e.jsx(Ae,{className:Ks,size:"100%",children:e.jsxs(R,{justify:"space-between",children:[e.jsxs(R,{children:[e.jsx(on,{openDrawer:r}),e.jsx(pn,{})]}),C&&e.jsx(T,{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:C}})}),e.jsxs(R,{children:[e.jsx(N,{position:"bottom-end",label:l._({id:"A1taO8"}),children:e.jsx(V,{onClick:d,variant:"transparent","aria-label":"open-search",children:e.jsx(ue,{})})}),e.jsx(tn,{}),I.isSet("BARCODE_ENABLE")&&e.jsx(en,{}),e.jsx(Xt,{radius:"lg",size:"18",label:b,color:"red",disabled:b<=0,inline:!0,children:e.jsx(N,{position:"bottom-end",label:l._({id:"iDNBZe"}),children:e.jsx(V,{onClick:u,variant:"transparent","aria-label":"open-notifications",children:e.jsx(qt,{})})})}),e.jsx(ms,{}),e.jsx(sn,{})]})]})})]})}function pn(){const s=B(),t=$(),n=us(":tabName/*"),o=n==null?void 0:n.params.tabName,r=De(s),i=Ce(),a=h.useMemo(()=>i.isSet("ICONS_IN_NAVBAR",!1),[i]),d=gs({featureType:"navigation",context:{}}),m=h.useMemo(()=>{const c=[];return De(s).forEach(p=>{p.role&&!s.hasViewRole(p.role)||c.push(e.jsx(re.Tab,{value:p.name,leftSection:a&&p.icon&&e.jsx(V,{variant:"transparent",children:p.icon}),onClick:f=>Q(`/${p.name}`,t,f),children:e.jsx(ie,{component:"a",href:ss(`/${Ze()}/${p.name}`),children:p.title})},p.name))}),d.forEach(p=>{c.push(e.jsx(re.Tab,{value:p.options.title,onClick:f=>Q(p.options.options.url,t,f),children:p.options.title},p.options.key))}),c},[d,r,s,a]);return e.jsx(re,{defaultValue:"home",classNames:{root:Gs,list:Xs,tab:qs},value:o,children:e.jsx(re.List,{children:m.map(c=>c)})})}const gn=({children:s})=>{const t=Xe(),{isLoggedIn:n}=B();return n()?s:e.jsx(ps,{to:"/logged-in",state:{redirectUrl:t.pathname,queryParams:t.search,anchor:t.hash}})},[mn,fn]=tt();function Vn(){const s=$(),t=Xe(),n=Fs(s),[o,r]=h.useState(n),[i,a]=h.useState(!1);return h.useEffect(()=>{i&&(r(n),a(!1))},[t]),e.jsx(gn,{children:e.jsxs(Me,{direction:"column",mih:"100vh",children:[e.jsx(hn,{}),e.jsx(Ae,{className:ot,size:"100%",children:e.jsx(Ie,{label:"layout",children:e.jsx(hs,{})})}),e.jsx(G,{h:"xl"}),e.jsx(Ys,{}),e.jsx(z,{actions:o,store:mn,highlightQuery:!0,searchProps:{leftSection:e.jsx(ue,{size:"1.2rem"}),placeholder:l._({id:"YIix5Y"})},shortcut:["mod + K","/"],nothingFound:l._({id:"cNfZ4r"})})]})})}export{gn as ProtectedRoute,Vn as default,fn as firstSpotlight,mn as firstStore};
//# sourceMappingURL=Layout-DenXtWTC.js.map
